doctype 5
html(lang='en')
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge,chrome=1')
    meta(name='viewport', content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no')

    title Dropbucket

    link(rel='stylesheet', href='/static/css/bootstrap.min.css')
    link(rel='stylesheet', href='/static/css/bootstrap-theme.min.css')
    link(rel='stylesheet', href='/static/css/main.css')

  body
    header#header
      .container
        .row
          #title.col-xs-12.col-sm-5.col-md-3.col-md-offset-2
            h1.col-xs-center.col-sm-right.col-lg-left Dropbucket
          .col-xs-12.col-sm-6.col-md-3
            #subtitle
              h2.col-xs-center.col-sm-right
                | upload files
                br
                | download files
                br
                small nothing else

    #content
      .container
        .row
          .col-xs-12.col-sm-6#upload-container
            .row
              .col-xs-12.col-sm-5.col-md-4
                h3.col-xs-center.col-sm-right up
              .col-xs-12.col-sm-7.col-md-8
                .col-xs-center.col-sm-left
                  h4 drag and drop
                  form#upload-form(action='/upload/', method='post', enctype='multipart/form-data')
                    button#browse-button
                      span#browse browse
                      input(id='file-input', type='file', name='upload')
                    input(type='hidden', name='filesize', value='-1')
                    span#file-input-info.label
                    br
                    button#upload-button(id='upload-button', type='submit') upload

          .col-xs-12.col-sm-6#files-container
            .row
              .col-xs-12.col-sm-5.col-md-4
                h3.col-xs-center.col-sm-right down
              .col-xs-12.col-sm-7.col-md-8
                .col-xs-center.col-sm-left
                  h4 pick and click
                  .row#files
                    each file in files
                      .file-wrapper.col-xs-12.col-md-6.col-lg-4
                        .file
                          a(href='/download/'+file.name, download=file.name)
                            button.btn=file.name
                          p=file.created

    footer#footer
      // things and stuff
      h4 {{ quota_left }}MB remaining.<!--Next reset at {{ next_reset_time }}.-->

    #scripts
      script(src='/static/js/vendor/jquery-1.10.1.min.js')
      script(src='/static/js/vendor/bootstrap.min.js')
      script(src='/static/js/main.js')

    script(type='text/javascript').
        $("document").ready(function() {
            $('#upload-button').prop('disabled', true);
            
            var size_limit = {{size_limit}} / 1024 / 1024;
            
            $("#file-input").change(function (e) {
                var files = e.currentTarget.files;
                var filesize = ((files[0].size/1024)/1024).toFixed(4); //MB
                console.log(filesize[0].name);
                if (filesize > size_limit) {
                    $('#upload-button').prop('disabled', true);
                    alert("Selected file is larger than the " + 
                            size_limit + "MB limit.");
                } else {
                    $('#upload-button').prop('disabled', false);
                }
            });
        });
